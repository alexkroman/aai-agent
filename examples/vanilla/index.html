<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Voice Agent</title>
</head>
<body>
  <div id="app"></div>
  <script type="module">
    // In production, replace with your platform URL or CDN
    const PLATFORM = "http://localhost:3000";
    const { VoiceAgent } = await import(`${PLATFORM}/client.js`);

    VoiceAgent.start({
      element: "#app",
      platformUrl: PLATFORM.replace("http", "ws"),
      apiKey: "pk_your_publishable_key",
      instructions: "You are a helpful order tracking assistant. Be concise.",
      greeting: "Hi! I can help you check your order status.",
      voice: "jess",
      tools: {
        check_order: {
          description: "Look up order status by order ID",
          parameters: { order_id: { type: "string", description: "Order ID" } },
          handler: async (args, ctx) => {
            const resp = ctx.fetch(
              `https://api.example.com/orders/${args.order_id}`,
              { headers: { Authorization: `Bearer ${ctx.secrets.ORDERS_API_KEY}` } }
            );
            return resp.json();
          },
        },
        schedule_callback: {
          description: "Schedule a callback for the customer",
          parameters: {
            phone: { type: "string", description: "Phone number" },
            time: { type: "string?", description: "Preferred time, e.g. '2pm'" },
          },
          handler: async (args, ctx) => {
            const resp = ctx.fetch("https://api.example.com/callbacks", {
              method: "POST",
              headers: {
                Authorization: `Bearer ${ctx.secrets.ORDERS_API_KEY}`,
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ phone: args.phone, time: args.time ?? "next available" }),
            });
            return resp.json();
          },
        },
      },
    });
  </script>
</body>
</html>
